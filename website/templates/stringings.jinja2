{% extends "layout.jinja2" %}

{% block title %}
  Stringings
{% endblock %}

{% block main %}
  <form action="/stringings" method="post" class="row justify-content-center">
    <table class="table table-striped table-hover ">
      <thead>
      <tr>
        <th>Customer</th>
        <th>Racquet</th>
        <th>Tension</th>
        <th>String Type</th>
        <th class="text-center">Include String</th>
        <th>Price</th>
        <th>Recived</th>
        <th>Finished</th>
        <th>Returned</th>
        <th>Payed</th>
        <th></th>
      </tr>
      </thead>
      <tbody>
      {% for stringing in stringings %}
        <tr>
          <td>{{ stringing.customer.first_name }} {{ stringing.customer.last_name }}</td>
          <td>
            {{ stringing.racquet.model }}
            {% if stringing.racquet.release_year %}({{ stringing.racquet.release_year }}){% endif %}
          </td>
          <td>{{ stringing.tension }}</td>
          <td>{{ stringing.string_type }}</td>
          <td class="text-center">
            <input class="form-check-input" type="checkbox" value="1"
                   {% if stringing.include_string %}checked="checked"{% endif %} disabled="disabled"/>
          </td>
          <td>{{ "$%.2f"|format(stringing.price) }}</td>
          <td>{% if stringing.received_date %}{{ stringing.received_date }}{% else %}-{% endif %}</td>
          <td>{% if stringing.finished_date %}{{ stringing.finished_date }}{% else %}-{% endif %}</td>
          <td>{% if stringing.returned_date %}{{ stringing.returned_date }}{% else %}-{% endif %}</td>
          <td>{% if stringing.payment %}{{ stringing.payment }}{% else %}-{% endif %}</td>
          <td></td>
        </tr>
      {% endfor %}
      </tbody>
      <tfoot>
      <tr>
        <td>
          <select class="form-select form-select-sm" required="required" name="customer">
            <option selected disabled="disabled" value="">Select Customer</option>
            {% for customer in customers %}
              <option value="{{ customer.id }}">{{ customer.first_name }} {{ customer.last_name }}</option>
            {% endfor %}
          </select>
        </td>
        <td>
          <select class="form-select form-select-sm" required="required" name="raquet">
            <option selected disabled="disabled" value="">Select Racquet</option>
            {% for brand in racquets_by_brands %}
              <optgroup label="{{ brand }}">
                {% for racquet in racquets_by_brands[brand] %}
                  <option value="{{ racquet.id }}">{{ racquet.model }} ({{ racquet.release_year }})</option>
                {% endfor %}
              </optgroup>
            {% endfor %}
          </select>
        </td>
        <td>
          <input type="number"
                 name="tension"
                 required="required"
                 class="form-control form-control-sm"
                 placeholder="Tension"
                 min="20"
                 max="65"
                 step="0.1"
          />
        </td>
        <td>
          <input type="text"
                 name="string_type"
                 required="required"
                 class="form-control form-control-sm"
                 placeholder="String"
                 autocomplete="off"
          />
        </td>
        <td class="align-middle text-center">
          <input class="form-check-input" name="include_string" type="checkbox" value="1"/>
        </td>
        <td>
          <div class="input-group input-group-sm">
            <div class="input-group-text">$</div>
            <input type="number"
                   name="price"
                   required="required"
                   class="form-control"
                   placeholder="Price"
                   min="0"
                   step="0.01"
            />
          </div>
        </td>
        <td>
          <input type="date"
                 name="date_received"
                 required="required"
                 class="form-control form-control-sm"
                 placeholder="Received"
          />
        </td>
        <td>
          <input type="date"
                 name="date_finished"
                 class="form-control form-control-sm"
                 placeholder="Finished"
          />
        </td>
        <td>
          <input type="date"
                 name="date_returned"
                 class="form-control form-control-sm"
                 placeholder="Returned"
          />
        </td>
        <td>
        </td>
        <td class="col-action">
          <button class="btn btn-primary btn-sm" type="submit"><i class="bi bi-plus"></i> Add Stringing</button>
        </td>
      </tr>
      </tfoot>
    </table>
  </form>
{% endblock %}